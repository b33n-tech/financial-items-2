<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Items Budgeting App - Boutons Només</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: Arial, sans-serif; background: #f0f2f5; margin: 10px; text-align: center; }
h1 { font-size: 1.8em; margin-bottom: 15px; }
.category { display: flex; align-items: center; justify-content: center; margin: 10px 0; gap: 15px; }
button.item-btn { font-size: 1.4em; padding: 15px 25px; border: none; border-radius: 10px; cursor: pointer; color: white; transition: background 0.2s; }
button.item-btn:disabled { background: #aaa; cursor: not-allowed; }
.counter { font-size: 1.2em; width: 50px; text-align: center; }
button#resetBtn { margin-top: 20px; font-size: 1.2em; padding: 10px 20px; border: none; border-radius: 8px; cursor: pointer; background: #dc3545; color: white; }
.history { margin-top: 20px; max-height: 200px; overflow-y: auto; background: #fff; padding: 10px; border-radius: 8px; box-shadow: 0 2px 6px rgba(0,0,0,0.15);}
</style>
</head>
<body>

<h1>Items Budgeting App</h1>

<div id="categories"></div>

<button id="resetBtn">Réinitialiser tout</button>

<div class="history" id="historyContainer">
<h2>Historique</h2>
<ul id="historyList"></ul>
</div>

<script>
// Données initiales
let defaultCategories = [
    { name: "Burgers", total: 3, remaining: 3, color: "#007bff" },
    { name: "Equipement", total: 5, remaining: 5, color: "#dc3545" },
    { name: "Bonbons", total: 12, remaining: 12, color: "#ffc107" }
];

let categories = JSON.parse(localStorage.getItem('categories')) || defaultCategories;
let history = JSON.parse(localStorage.getItem('history')) || [];

function saveState() {
    localStorage.setItem('categories', JSON.stringify(categories));
    localStorage.setItem('history', JSON.stringify(history));
}

// Rendu catégories
function renderCategories() {
    const container = document.getElementById('categories');
    container.innerHTML = '';
    categories.forEach((cat, i) => {
        const div = document.createElement('div');
        div.className = 'category';
        
        const btn = document.createElement('button');
        btn.className = 'item-btn';
        btn.textContent = cat.name;
        btn.style.backgroundColor = cat.color;
        btn.disabled = cat.remaining <= 0;
        btn.onclick = () => consumeItem(i);
        
        const counter = document.createElement('div');
        counter.className = 'counter';
        counter.textContent = `${cat.remaining}/${cat.total}`;
        
        div.appendChild(btn);
        div.appendChild(counter);
        container.appendChild(div);
    });
}

// Consommer un item
function consumeItem(catIndex){
    const cat = categories[catIndex];
    if(cat.remaining > 0){
        cat.remaining--;
        const now = new Date().toLocaleString();
        history.unshift({ category: cat.name, qty: 1, timestamp: now });
        saveState();
        renderCategories();
        renderHistory();
    }
}

// Historique
function renderHistory(){
    const ul = document.getElementById('historyList');
    ul.innerHTML = '';
    history.forEach(h => {
        const li = document.createElement('li');
        li.textContent = `${h.timestamp}: ${h.qty} ${h.category}`;
        ul.appendChild(li);
    });
}

// Reset
document.getElementById('resetBtn').onclick = () => {
    if(confirm("Confirmez-vous la réinitialisation de tout ?")){
        categories = defaultCategories.map(c => ({ ...c, remaining: c.total }));
        history = [];
        saveState();
        renderCategories();
        renderHistory();
    }
}

// Initial render
renderCategories();
renderHistory();
</script>

</body>
</html>
